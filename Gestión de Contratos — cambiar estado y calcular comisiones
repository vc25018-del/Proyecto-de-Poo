public class ContratoService {
    private ContratoDAO contratoDAO = new ContratoDAO();
    private PropiedadDAO propiedadDAO = new PropiedadDAO();
    private EmpleadoDAO empleadoDAO = new EmpleadoDAO();

    public void crearContrato(Contrato c) {
        // validaciones esenciales
        Propiedad p = propiedadDAO.buscarPorCodigo(c.getPropiedadCodigo());
        if (p == null) throw new IllegalArgumentException("Propiedad no encontrada");
        if (!p.getEstado().equalsIgnoreCase("disponible")) throw new IllegalStateException("Propiedad no disponible");

        // insertar contrato
        contratoDAO.insertar(c);

        // cambiar estado de propiedad
        if (c.getTipoOperacion().equalsIgnoreCase("venta")) {
            p.setEstado("vendida");
        } else if (c.getTipoOperacion().equalsIgnoreCase("alquiler")) {
            p.setEstado("alquilada");
        }
        propiedadDAO.actualizar(p);

        // calcular comisión
        double comision = calcularComision(c);
        // asignar comisión al empleado (simple: imprimir o actualizar registro de empleado)
        Empleado emp = empleadoDAO.buscarPorCodigo(c.getEmpleadoCodigo());
        if (emp != null) {
            // lógica: podrías guardar comisiones en otra colección o sumar a un campo
            System.out.println("Comisión para " + emp.getNombre() + ": " + comision);
        }
    }

    private double calcularComision(Contrato c) {
        if (c.getTipoOperacion().equalsIgnoreCase("venta")) {
            return c.getMonto() * 0.03; // 3%
        } else { // alquiler
            return c.getMonto(); // ej: primer mes
        }
    }
}
