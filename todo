pom.xml

<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://
maven.apache.org/xsd/maven-4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>com.inmobiliaria</groupId>
<artifactId>inmobiliaria</artifactId>
<version>1.0-SNAPSHOT</version>
<properties>
<maven.compiler.source>11</maven.compiler.source>
<maven.compiler.target>11</maven.compiler.target>
</properties>
<dependencies>
<!-- MongoDB Driver -->
<dependency>
<groupId>org.mongodb</groupId>
<artifactId>mongodb-driver-sync</artifactId>
<version>4.11.1</version>
</dependency>
<!-- BCrypt para hashear contraseñas -->
<dependency>
<groupId>at.favre.lib</groupId>
<artifactId>bcrypt</artifactId>
<version>0.9.0</version>
</dependency>
<!-- JUnit (opcional para pruebas) -->
<dependency>
<groupId>org.junit.jupiter</groupId>
<artifactId>junit-jupiter</artifactId>
<version>5.9.3</version>
<scope>test</scope>
</dependency>
</dependencies>
</project>
 
Estructura de paquetes (copiar en	)

Archivos Java

package  com.inmobiliaria.config; import com.mongodb.client.MongoClient;
import com.mongodb.client.MongoClients; import com.mongodb.client.MongoDatabase;

public class MongoDBConnection {
private static MongoDBConnection instance; private MongoClient mongoClient;
private MongoDatabase database;

private MongoDBConnection() {
String uri = System.getenv().getOrDefault("MONGODB_URI","mongodb:// localhost:27017");
String dbName = System.getenv().getOrDefault("MONGODB_DB","inmobiliaria");
mongoClient = MongoClients.create(uri); database = mongoClient.getDatabase(dbName);
}

public static synchronized MongoDBConnection getInstance() { if (instance == null) {
instance = new MongoDBConnection();
}
return instance;
}

public MongoDatabase getDatabase() { return database;
}

public void close() {
if (mongoClient != null) mongoClient.close();
}
}
 
Models

package com.inmobiliaria.model; public class Propiedad {
private String codigo;
private String tipo; // casa, apartamento, local private String direccion;
private double precio;
private String estado; // disponible, vendida, alquilada private String propietarioId;

public Propiedad() {}

public Propiedad(String codigo, String tipo, String direccion, double precio, String estado, String propietarioId) {
this.codigo = codigo; this.tipo = tipo; this.direccion = direccion; this.precio = precio; this.estado = estado;
this.propietarioId = propietarioId;
}

public String getCodigo() { return codigo; }
public void setCodigo(String codigo) { this.codigo = codigo; } public String getTipo() { return tipo; }
public void setTipo(String tipo) { this.tipo = tipo; } public String getDireccion() { return direccion; }
public void setDireccion(String direccion) { this.direccion = direccion; }
public double getPrecio() { return precio; }
public void setPrecio(double precio) { this.precio = precio; } public String getEstado() { return estado; }
public void setEstado(String estado) { this.estado = estado; } public String getPropietarioId() { return propietarioId; }
public void setPropietarioId(String propietarioId) { this.propietarioId
= propietarioId; }

@Override
public String toString() { return "Propiedad{" +
"codigo='" + codigo + '\'' + ", tipo='" + tipo + '\'' +
", direccion='" + direccion + '\'' + ", precio=" + precio +
", estado='" + estado + '\'' +
", propietarioId='" + propietarioId + '\'' +
 





 
package com.inmobiliaria.model; public class Cliente {
private String id; private String nombre; private String apellido; private String telefono; private String correo;
private String tipo; // comprador o arrendatario public Cliente() {}
public Cliente(String id, String nombre, String apellido, String telefono, String correo, String tipo) {
this.id = id; this.nombre = nombre;
this.apellido = apellido; this.telefono = telefono; this.correo = correo; this.tipo = tipo;
}

public String getId() { return id; }
public void setId(String id) { this.id = id; } public String getNombre() { return nombre; }
public void setNombre(String nombre) { this.nombre = nombre; } public String getApellido() { return apellido; }
public void setApellido(String apellido) { this.apellido = apellido; } public String getTelefono() { return telefono; }
public void setTelefono(String telefono) { this.telefono = telefono; } public String getCorreo() { return correo; }
public void setCorreo(String correo) { this.correo = correo; } public String getTipo() { return tipo; }
public void setTipo(String tipo) { this.tipo = tipo; }

@Override
public String toString() {
return nombre + " " + apellido + " (" + id + ")";
}
}
 
 

package com.inmobiliaria.model; import java.util.List;
public class Empleado { private String codigo; private String nombre; private String cargo; private double salario;
private List<String> propiedadesGestionadas; public Empleado() {}
public Empleado(String codigo, String nombre, String cargo, double salario, List<String> propiedadesGestionadas) {
this.codigo = codigo; this.nombre = nombre; this.cargo = cargo; this.salario = salario;
this.propiedadesGestionadas  =  propiedadesGestionadas;
}

public String getCodigo() { return codigo; }
public void setCodigo(String codigo) { this.codigo = codigo; } public String getNombre() { return nombre; }
public void setNombre(String nombre) { this.nombre = nombre; } public String getCargo() { return cargo; }
public void setCargo(String cargo) { this.cargo = cargo; } public double getSalario() { return salario; }
public void setSalario(double salario) { this.salario = salario; } public List<String> getPropiedadesGestionadas() { return
propiedadesGestionadas; }
public void setPropiedadesGestionadas(List<String> propiedadesGestionadas) { this.propiedadesGestionadas = propiedadesGestionadas; }
}

 
private String correo;
private List<String> propiedades; public Propietario() {}
public Propietario(String id, String nombre, String telefono, String correo, List<String> propiedades) {
this.id = id; this.nombre = nombre;
this.telefono = telefono; this.correo = correo; this.propiedades = propiedades;
}

public String getId() { return id; }
public void setId(String id) { this.id = id; } public String getNombre() { return nombre; }
public void setNombre(String nombre) { this.nombre = nombre; } public String getTelefono() { return telefono; }
public void setTelefono(String telefono) { this.telefono = telefono; } public String getCorreo() { return correo; }
public void setCorreo(String correo) { this.correo = correo; } public List<String> getPropiedades() { return propiedades; }
public void setPropiedades(List<String> propiedades) { this.propiedades
= propiedades; }
}

 
this.propiedadCodigo = propiedadCodigo; this.tipoOperacion = tipoOperacion; this.fechaInicio = fechaInicio; this.fechaFin = fechaFin;
this.monto = monto; this.empleadoCodigo = empleadoCodigo;
}

public String getId() { return id; }
public void setId(String id) { this.id = id; } public String getClienteId() { return clienteId; }
public void setClienteId(String clienteId) { this.clienteId = clienteId; }
public String getPropiedadCodigo() { return propiedadCodigo; } public void setPropiedadCodigo(String propiedadCodigo) {
this.propiedadCodigo = propiedadCodigo; }
public String getTipoOperacion() { return tipoOperacion; }
public void setTipoOperacion(String tipoOperacion) { this.tipoOperacion
= tipoOperacion; }
public LocalDate getFechaInicio() { return fechaInicio; }
public void setFechaInicio(LocalDate fechaInicio) { this.fechaInicio = fechaInicio; }
public LocalDate getFechaFin() { return fechaFin; }
public void setFechaFin(LocalDate fechaFin) { this.fechaFin = fechaFin; } public double getMonto() { return monto; }
public void setMonto(double monto) { this.monto = monto; } public String getEmpleadoCodigo() { return empleadoCodigo; } public void setEmpleadoCodigo(String empleadoCodigo) {
this.empleadoCodigo = empleadoCodigo; }
}

DAOs

Nota: Los DAOs usan

y	.
 
package com.inmobiliaria.dao;

import com.inmobiliaria.config.MongoDBConnection; import com.inmobiliaria.model.Propiedad;
import com.mongodb.client.MongoCollection; import com.mongodb.client.MongoDatabase; import org.bson.Document;
import org.bson.conversions.Bson; import  java.util.ArrayList; import java.util.List;
import static com.mongodb.client.model.Filters.eq;

public class PropiedadDAO {
private final MongoCollection<Document> collection;

public PropiedadDAO() {
MongoDatabase db = MongoDBConnection.getInstance().getDatabase(); this.collection  =  db.getCollection("propiedades");
}

private Document toDocument(Propiedad p) {
Document doc = new Document("codigo", p.getCodigo())
.append("tipo", p.getTipo())
.append("direccion", p.getDireccion())
.append("precio", p.getPrecio())
.append("estado", p.getEstado())
.append("propietarioId", p.getPropietarioId()); return doc;
}

private Propiedad fromDocument(Document doc) { if (doc == null) return null;
Propiedad p = new Propiedad(); p.setCodigo(doc.getString("codigo")); p.setTipo(doc.getString("tipo"));
 
p.setDireccion(doc.getString("direccion"));  Object precioObj = doc.get("precio");
if (precioObj instanceof Double) { p.setPrecio((Double) precioObj);
} else if (precioObj instanceof Integer) { p.setPrecio(((Integer) precioObj).doubleValue());
} else if (precioObj != null) { p.setPrecio(Double.parseDouble(precioObj.toString()));
}
p.setEstado(doc.getString("estado")); p.setPropietarioId(doc.getString("propietarioId")); return p;
}

public void insertar(Propiedad p) { collection.insertOne(toDocument(p));
}

public List<Propiedad> obtenerTodas() { List<Propiedad> lista = new ArrayList<>(); for (Document d : collection.find()) {
lista.add(fromDocument(d));
}
return lista;
}

public Propiedad buscarPorCodigo(String codigo) {
Document d = collection.find(eq("codigo", codigo)).first(); return fromDocument(d);
}

public void actualizar(Propiedad p) {
Bson filter = eq("codigo", p.getCodigo()); collection.replaceOne(filter, toDocument(p));
}

public void eliminar(String codigo) { collection.deleteOne(eq("codigo", codigo));
}
}

 
import static com.mongodb.client.model.Filters.eq; import java.util.ArrayList;
import java.util.List;

public class ClienteDAO {
private final MongoCollection<Document> collection;

public ClienteDAO() {
MongoDatabase db = MongoDBConnection.getInstance().getDatabase(); this.collection  =  db.getCollection("clientes");
}

private Document toDocument(Cliente c) { return new Document("id", c.getId())
.append("nombre", c.getNombre())
.append("apellido", c.getApellido())
.append("telefono", c.getTelefono())
.append("correo", c.getCorreo())
.append("tipo", c.getTipo());
}

private Cliente fromDocument(Document d) { if (d == null) return null;
Cliente c = new Cliente(); c.setId(d.getString("id")); c.setNombre(d.getString("nombre")); c.setApellido(d.getString("apellido")); c.setTelefono(d.getString("telefono")); c.setCorreo(d.getString("correo")); c.setTipo(d.getString("tipo"));
return c;
}

public void insertar(Cliente c) { collection.insertOne(toDocument(c)); } public List<Cliente> obtenerTodos() {
List<Cliente> lista = new ArrayList<>();
for (Document d: collection.find()) lista.add(fromDocument(d)); return lista;
}
public Cliente buscarPorId(String id) { return fromDocument(collection.find(eq("id", id)).first()); }
public void actualizar(Cliente c) { collection.replaceOne(eq("id", c.getId()), toDocument(c)); }
public void eliminar(String id) { collection.deleteOne(eq("id", id)); }
}

 
import com.inmobiliaria.config.MongoDBConnection; import com.inmobiliaria.model.Empleado;
import com.mongodb.client.MongoCollection; import com.mongodb.client.MongoDatabase; import org.bson.Document;
import static com.mongodb.client.model.Filters.eq; import java.util.ArrayList;
import java.util.List;

public class EmpleadoDAO {
private final MongoCollection<Document> collection;

public EmpleadoDAO() {
MongoDatabase db = MongoDBConnection.getInstance().getDatabase(); this.collection  =  db.getCollection("empleados");
}

private Document toDocument(Empleado e) {
Document doc = new Document("codigo", e.getCodigo())
.append("nombre", e.getNombre())
.append("cargo", e.getCargo())
.append("salario", e.getSalario())
.append("propiedadesGestionadas", e.getPropiedadesGestionadas());
return doc;
}

private Empleado fromDocument(Document d) { if (d == null) return null;
Empleado e = new Empleado(); e.setCodigo(d.getString("codigo")); e.setNombre(d.getString("nombre")); e.setCargo(d.getString("cargo")); Object s = d.get("salario");
if (s instanceof Double) e.setSalario((Double) s); else if (s instanceof Integer) e.setSalario(((Integer)
s).doubleValue());
e.setPropiedadesGestionadas((List<String>) d.get("propiedadesGestionadas"));
return e;
}

public void insertar(Empleado e) { collection.insertOne(toDocument(e)); } public List<Empleado> obtenerTodos() {
List<Empleado> lista = new ArrayList<>();
for (Document d: collection.find()) lista.add(fromDocument(d)); return lista;
}
public Empleado buscarPorCodigo(String codigo) { return fromDocument(collection.find(eq("codigo", codigo)).first()); }
public void actualizar(Empleado e) { collection.replaceOne(eq("codigo",

package com.inmobiliaria.dao;

import com.inmobiliaria.config.MongoDBConnection; import  com.inmobiliaria.model.Propietario;
import com.mongodb.client.MongoCollection; import com.mongodb.client.MongoDatabase; import org.bson.Document;
import static com.mongodb.client.model.Filters.eq; import java.util.ArrayList;
import java.util.List;

public class PropietarioDAO {
private final MongoCollection<Document> collection;

public PropietarioDAO() {
MongoDatabase db = MongoDBConnection.getInstance().getDatabase(); this.collection   =   db.getCollection("propietarios");
}

private Document toDocument(Propietario p) { return new Document("id", p.getId())
.append("nombre", p.getNombre())
.append("telefono", p.getTelefono())
.append("correo", p.getCorreo())
.append("propiedades", p.getPropiedades());
}

private Propietario fromDocument(Document d) { if (d == null) return null;
Propietario p = new Propietario(); p.setId(d.getString("id")); p.setNombre(d.getString("nombre")); p.setTelefono(d.getString("telefono")); p.setCorreo(d.getString("correo")); p.setPropiedades((List<String>) d.get("propiedades")); return p;
}

public void insertar(Propietario p) { collection.insertOne(toDocument(p)); }
public List<Propietario> obtenerTodos() { List<Propietario> lista = new ArrayList<>();
for (Document d: collection.find()) lista.add(fromDocument(d));

package com.inmobiliaria.dao;

import com.inmobiliaria.config.MongoDBConnection; import com.inmobiliaria.model.Contrato;
import com.mongodb.client.MongoCollection; import com.mongodb.client.MongoDatabase; import org.bson.Document;
import static com.mongodb.client.model.Filters.eq; import java.time.format.DateTimeFormatter;
import java.util.ArrayList; import java.util.List;

public class ContratoDAO {
private final MongoCollection<Document> collection;
private final DateTimeFormatter fmt = DateTimeFormatter.ISO_LOCAL_DATE;

public ContratoDAO() {
MongoDatabase db = MongoDBConnection.getInstance().getDatabase(); this.collection  =  db.getCollection("contratos");
}

private Document toDocument(Contrato c) { Document doc = new Document("id", c.getId())
.append("clienteId", c.getClienteId())
.append("propiedadCodigo", c.getPropiedadCodigo())
.append("tipoOperacion", c.getTipoOperacion())
.append("monto", c.getMonto())
.append("empleadoCodigo", c.getEmpleadoCodigo()); if (c.getFechaInicio() != null) doc.append("fechaInicio",
c.getFechaInicio().format(fmt));
if (c.getFechaFin() != null) doc.append("fechaFin", c.getFechaFin().format(fmt));
return doc;
}

private Contrato fromDocument(Document d) { if (d == null) return null;
Contrato c = new Contrato(); c.setId(d.getString("id"));
 
c.setClienteId(d.getString("clienteId"));   c.setPropiedadCodigo(d.getString("propiedadCodigo")); c.setTipoOperacion(d.getString("tipoOperacion")); Object montoObj = d.get("monto");
if (montoObj instanceof Double) c.setMonto((Double) montoObj); else if (montoObj instanceof Integer) c.setMonto(((Integer)
montoObj).doubleValue());
else if (montoObj != null) c.setMonto(Double.parseDouble(montoObj.toString()));
c.setEmpleadoCodigo(d.getString("empleadoCodigo")); if (d.containsKey("fechaInicio"))
c.setFechaInicio(java.time.LocalDate.parse(d.getString("fechaInicio")));  if (d.containsKey("fechaFin"))
c.setFechaFin(java.time.LocalDate.parse(d.getString("fechaFin"))); return c;
}

public void insertar(Contrato c) { collection.insertOne(toDocument(c)); } public List<Contrato> obtenerTodos() {
List<Contrato> lista = new ArrayList<>();
for (Document d: collection.find()) lista.add(fromDocument(d)); return lista;
}
public Contrato buscarPorId(String id) { return fromDocument(collection.find(eq("id", id)).first()); }
public void actualizar(Contrato c) { collection.replaceOne(eq("id", c.getId()), toDocument(c)); }
public void eliminar(String id) { collection.deleteOne(eq("id", id)); }
}


(simple para login)

package com.inmobiliaria.service;

import com.inmobiliaria.dao.ContratoDAO; import com.inmobiliaria.dao.PropiedadDAO; import com.inmobiliaria.dao.EmpleadoDAO; import com.inmobiliaria.model.Contrato; import com.inmobiliaria.model.Propiedad; import com.inmobiliaria.model.Empleado;

public class ContratoService {
private final ContratoDAO contratoDAO = new ContratoDAO(); private final PropiedadDAO propiedadDAO = new PropiedadDAO(); private final EmpleadoDAO empleadoDAO = new EmpleadoDAO();

public void crearContrato(Contrato c) {
Propiedad p = propiedadDAO.buscarPorCodigo(c.getPropiedadCodigo()); if (p == null) throw new IllegalArgumentException("Propiedad no
encontrada");
if (!"disponible".equalsIgnoreCase(p.getEstado())) throw new IllegalStateException("Propiedad no disponible");

contratoDAO.insertar(c);

if ("venta".equalsIgnoreCase(c.getTipoOperacion())) { p.setEstado("vendida");
} else if ("alquiler".equalsIgnoreCase(c.getTipoOperacion())) { p.setEstado("alquilada");

Utilidades

package com.inmobiliaria.util; import java.util.regex.Pattern; public class Validator {
private static final Pattern EMAIL_PATTERN = Pattern.compile( "^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,6}$",
Pattern.CASE_INSENSITIVE);
private static final Pattern PHONE_PATTERN = Pattern.compile("^\\+?[0-9]
{7,15}$");

public static boolean isEmailValid(String email) { if (email == null) return false;
return EMAIL_PATTERN.matcher(email).matches();
}

public static boolean isPhoneValid(String phone) { if (phone == null) return false;
return PHONE_PATTERN.matcher(phone).matches();
}

public static boolean isPositive(double value) { return value > 0; } public static boolean isNotEmpty(String s) { return s != null && !
s.trim().isEmpty(); }
}
 

UI
y


package com.inmobiliaria.ui;

import com.inmobiliaria.dao.UsuarioDAO; import com.inmobiliaria.model.Usuario; import at.favre.lib.crypto.bcrypt.BCrypt; import com.inmobiliaria.util.Validator;

import javax.swing.*; import java.awt.*;

public class LoginFrame extends JFrame { private JTextField txtUser;
private JPasswordField txtPass; private JButton btnLogin;
private final UsuarioDAO usuarioDAO = new UsuarioDAO();

public LoginFrame() { setTitle("Inmobiliaria - Login");
setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); setSize(350,200);
setLocationRelativeTo(null); initComponents();
}

private void initComponents() { txtUser = new JTextField(); txtPass = new JPasswordField();
btnLogin = new JButton("Ingresar");

JPanel panel = new JPanel(new GridLayout(3,2,5,5)); panel.setBorder(BorderFactory.createEmptyBorder(10,10,10,10));  panel.add(new JLabel("Usuario:"));
panel.add(txtUser);
panel.add(new JLabel("Contraseña:")); panel.add(txtPass);
panel.add(new JLabel()); panel.add(btnLogin);

add(panel);

btnLogin.addActionListener(e -> autenticar());
}
 
JMenuItem itemEmpleados = new JMenuItem("Empleados"); JMenuItem itemContratos = new JMenuItem("Contratos"); JMenuItem itemPropietarios = new JMenuItem("Propietarios");

menuGestiones.add(itemPropiedades); menuGestiones.add(itemClientes); menuGestiones.add(itemEmpleados); menuGestiones.add(itemContratos); menuGestiones.add(itemPropietarios); menuBar.add(menuGestiones); setJMenuBar(menuBar);

getContentPane().setLayout(new BorderLayout()); JPanel defaultPanel = new JPanel(); defaultPanel.add(new JLabel("Bienvenido al sistema de
Inmobiliaria"));
getContentPane().add(defaultPanel, BorderLayout.CENTER);

itemPropiedades.addActionListener(e -> { getContentPane().removeAll();
getContentPane().add(new PropiedadPanel(), BorderLayout.CENTER); revalidate();
repaint();
});

// Los demás items pueden implementar paneles análogos
}
}

 
}

private void initComponents() {
tableModel = new DefaultTableModel(new Object[]
{"Código","Tipo","Dirección","Precio","Estado","Propietario"}, 0) { @Override
public boolean isCellEditable(int row, int column) { return
false; }
};
table = new JTable(tableModel);
add(new JScrollPane(table), BorderLayout.CENTER);

JPanel controls = new JPanel();
JButton btnNuevo = new JButton("Nuevo"); JButton btnEditar = new JButton("Editar"); JButton btnEliminar = new JButton("Eliminar"); JButton btnBuscar = new JButton("Buscar");

controls.add(btnNuevo); controls.add(btnEditar); controls.add(btnEliminar); controls.add(btnBuscar); add(controls, BorderLayout.SOUTH);

btnNuevo.addActionListener(e -> abrirDialogoCrear()); btnEditar.addActionListener(e -> abrirDialogoEditar()); btnEliminar.addActionListener(e -> eliminarSeleccion()); btnBuscar.addActionListener(e -> buscarPorCodigo());
}

private void loadData() { tableModel.setRowCount(0);
List<Propiedad> lista = propiedadDAO.obtenerTodas(); for (Propiedad p : lista) {
tableModel.addRow(new Object[]{p.getCodigo(), p.getTipo(), p.getDireccion(), p.getPrecio(), p.getEstado(), p.getPropietarioId()});
}
}

private void abrirDialogoCrear() {
PropiedadDialog dialog = new PropiedadDialog(null); dialog.setModal(true);
dialog.setVisible(true);
Propiedad p = dialog.getPropiedad(); if (p != null) {
propiedadDAO.insertar(p); loadData();
}
}

private void abrirDialogoEditar() {
 
int row = table.getSelectedRow();
if (row == -1) { JOptionPane.showMessageDialog(this, "Seleccione una fila"); return; }
String codigo = (String)tableModel.getValueAt(row, 0); Propiedad p = propiedadDAO.buscarPorCodigo(codigo);
if (p == null) { JOptionPane.showMessageDialog(this, "Propiedad no encontrada"); return; }
PropiedadDialog dialog = new PropiedadDialog(p); dialog.setModal(true);
dialog.setVisible(true);
Propiedad updated = dialog.getPropiedad(); if (updated != null) {
propiedadDAO.actualizar(updated); loadData();
}
}

private void eliminarSeleccion() { int row = table.getSelectedRow();
if (row == -1) { JOptionPane.showMessageDialog(this, "Seleccione una fila"); return; }
String codigo = (String)tableModel.getValueAt(row, 0);
int resp = JOptionPane.showConfirmDialog(this, "¿Eliminar propiedad " + codigo + "?", "Confirmar", JOptionPane.YES_NO_OPTION);
if (resp == JOptionPane.YES_OPTION) { propiedadDAO.eliminar(codigo); loadData();
}
}

private void buscarPorCodigo() {
String codigo = JOptionPane.showInputDialog(this, "Ingrese código de propiedad:");
if (codigo == null || codigo.trim().isEmpty()) return; Propiedad p = propiedadDAO.buscarPorCodigo(codigo);
if (p == null) JOptionPane.showMessageDialog(this, "No encontrada"); else JOptionPane.showMessageDialog(this, "Código: " + p.getCodigo()
+ "\nDirección: " + p.getDireccion());
}
}

 

public class PropiedadDialog extends JDialog { private JTextField txtCodigo;
private JComboBox<String> cbTipo; private JTextField txtDireccion; private JSpinner spPrecio;
private JComboBox<String> cbEstado; private JTextField txtPropietario; private Propiedad propiedad;

public PropiedadDialog(Propiedad p) {
setTitle(p == null ? "Nueva Propiedad" : "Editar Propiedad"); setSize(400,300);
setLocationRelativeTo(null); initComponents();
if (p != null) loadPropiedad(p);
}

private void initComponents() { txtCodigo = new JTextField();
cbTipo = new JComboBox<>(new String[]{"casa","apartamento","local"}); txtDireccion = new JTextField();
spPrecio = new JSpinner(new SpinnerNumberModel(0.0, 0.0, Double.MAX_VALUE, 100.0));
cbEstado = new JComboBox<>(new String[]
{"disponible","vendida","alquilada"});  txtPropietario = new JTextField();

JPanel panel = new JPanel(new GridLayout(6,2,5,5)); panel.setBorder(BorderFactory.createEmptyBorder(10,10,10,10)); panel.add(new JLabel("Código:")); panel.add(txtCodigo); panel.add(new JLabel("Tipo:")); panel.add(cbTipo); panel.add(new JLabel("Dirección:")); panel.add(txtDireccion); panel.add(new JLabel("Precio:")); panel.add(spPrecio); panel.add(new JLabel("Estado:")); panel.add(cbEstado);
panel.add(new JLabel("Propietario ID:")); panel.add(txtPropietario);

JButton btnOk = new JButton("Guardar"); JButton btnCancel = new JButton("Cancelar"); btnOk.addActionListener(e -> onSave()); btnCancel.addActionListener(e -> onCancel());

JPanel south = new JPanel(); south.add(btnOk); south.add(btnCancel);

getContentPane().setLayout(new BorderLayout()); getContentPane().add(panel, BorderLayout.CENTER); getContentPane().add(south, BorderLayout.SOUTH);
}

private void loadPropiedad(Propiedad p) {
 
this.propiedad = p;
txtCodigo.setText(p.getCodigo()); txtCodigo.setEnabled(false); cbTipo.setSelectedItem(p.getTipo()); txtDireccion.setText(p.getDireccion()); spPrecio.setValue(p.getPrecio()); cbEstado.setSelectedItem(p.getEstado()); txtPropietario.setText(p.getPropietarioId());
}

private void onSave() {
String codigo = txtCodigo.getText();
String tipo = (String) cbTipo.getSelectedItem(); String direccion = txtDireccion.getText();
double precio = ((Number) spPrecio.getValue()).doubleValue(); String estado = (String) cbEstado.getSelectedItem();
String propietario = txtPropietario.getText();

if (!Validator.isNotEmpty(codigo) || !
Validator.isNotEmpty(direccion) || !Validator.isPositive(precio)) {
JOptionPane.showMessageDialog(this, "Complete los campos correctamente (precio positivo, sin campos vacíos)");
return;
}

if (propiedad == null) propiedad = new Propiedad(); propiedad.setCodigo(codigo); propiedad.setTipo(tipo); propiedad.setDireccion(direccion); propiedad.setPrecio(precio); propiedad.setEstado(estado); propiedad.setPropietarioId(propietario);

dispose();
}

private void onCancel() { propiedad = null; dispose(); }

public Propiedad getPropiedad() { return propiedad; }
}

